import streamlit as st

# --- ダイアログ（モーダルウィンドウ）の定義 ---
# width="large" に設定
@st.dialog("操作マニュアル", width="large")
def show_instructions():    
    # --- スクロールエリアの定義 ---
    # height=600 (ピクセル)
    # border=True で枠線を付ける
    with st.container(height=600, border=True):
        
        # 楽天の必須項目をリスト定義
        rakuten_items = [
            "商品管理番号（商品URL）", "商品番号", "商品名", "倉庫指定", "サーチ表示",
            "販売期間指定（開始日時）", "販売期間指定（終了日時）",
            "SKU管理番号", "販売価格", "在庫数", "SKU", "倉庫指定"
        ]

        # タグ風デザインのHTMLを生成
        # インデントによるコードブロック化を防ぐため、1行で記述
        tags_html = ""
        for item in rakuten_items:
            tags_html += f"""<span style="display: inline-block; padding: 4px 12px; margin: 4px 2px; background-color: #f0f2f6; color: #31333F; border: 1px solid #d1d5db; border-radius: 16px; font-size: 0.85em; font-weight: 500;">{item}</span>"""

        st.markdown(f"""
        本アプリは各ポータルにおける返礼品の掲載状況を一元確認できるツールで、掲載／停止の見落としを防ぐことを目的としています。
        各ポータルのデータファイルを読み込むことで、各ポータルの掲載状況を表示します。

        ---

        ## 🗃️1. データベース管理（※必要に応じて）
        以下については、[こちらのスプレッドシート](https://docs.google.com/spreadsheets/d/1Yb-0DLDb-IAKIxDkhaSZxDl-zd2iDHZ3aX3_4mSiQyI)の情報をもとに掲載状況の結果が出力されます。

        * **「定期便フラグ」列**：「定期便DB」シートを参照
        * **「事業者名」列**　　：「事業者DB」シートを参照
        * **楽天SKU親コード**　 ：「商品管理DB」シートを参照
        
        必要に応じてスプレッドシートの更新をお願いします。
        > **⚠️ 注意**
        > 新しいデータは一番下の行に新規追加してください。既存のデータを更新する場合は、他のデータを更新しないように注意してください。

        ## 📥2. インポート

        **① フィルター**
        
        フィルターエリア「返礼品コード」または「事業者コード」にフィルター対象のコードを入力をすることで、読み込むデータを絞り込むことができます。データを絞ることでアプリの動作が軽くなります。
        > ※チョイス在庫、さとふる在庫は仕様上、このフィルターの対象外です。
 
        **② ファイルのアップロード**
        
        各ポータルからDLしたデータファイルをアップロードしてください。（複数選択可）

        **「楽天」は下記の項目が必要です。**
                    
        <div style="margin-top: 5px; margin-bottom: 15px;">
        {tags_html}
        </div>

        > **⚠️ 注意**
        > 「チョイス」と「チョイス在庫」、「さとふる」と「さとふる在庫」は、それぞれ必ずセットでアップロードしてください。

        ## 🚀3. 実行
        基準となる「ポータル」と「基準日」を選択して、「掲載状況を表示」ボタンを押下してください。
        
        上記「2. インポート」が完了すると、「ポータル」の選択、「基準日」の設定、「掲載状況を表示」ボタンが有効化されます。
        
        **① ベースポータル選択**
        
        選択したポータルの返礼品データを基準として、全ポータルの掲載状況を横並びで比較・一覧化します。

        **② 基準日設定**
        
        ステータス判定（公開中、未受付、受付終了など）の基準となる日付です。
        * デフォルトは**本日**です。
        * 日付を変更することで、ステータス遷移のシミュレーション確認が可能です。
        
        """, unsafe_allow_html=True)